import{r as l,l as L,j as e,u as V,m as F,a as $}from"./index-DN6YVJy6.js";function O({onCapture:r,onCancel:g,maxSize:a=1024}){const[i,m]=l.useState("select"),[h,f]=l.useState(!1),[C,b]=l.useState(!1),[v,x]=l.useState(null),u=l.useRef(null),N=l.useRef(null),I=l.useRef(null),S=l.useCallback(async(t,s)=>new Promise((d,c)=>{const p=URL.createObjectURL(t),j=new Image,w=()=>{URL.revokeObjectURL(p)};j.onload=()=>{try{const k=Math.min(1,s/Math.max(j.width,j.height)),T=Math.round(j.width*k),H=Math.round(j.height*k);let E,A;if(typeof OffscreenCanvas<"u"?(E=new OffscreenCanvas(T,H),A=E.getContext("2d")):(E=document.createElement("canvas"),E.width=T,E.height=H,A=E.getContext("2d")),!A){w(),c(new Error("Canvas context not available"));return}A.drawImage(j,0,0,T,H),E instanceof OffscreenCanvas?E.convertToBlob({type:"image/jpeg",quality:.8}).then(M=>{w(),d(M)}).catch(M=>{w(),c(M)}):E.toBlob(M=>{w(),M?d(M):c(new Error("Failed to create blob"))},"image/jpeg",.8)}catch(k){w(),c(k)}},j.onerror=()=>{w(),c(new Error("Failed to load image"))},j.src=p}),[]),P=l.useCallback(async t=>{var d;const s=(d=t.target.files)==null?void 0:d[0];if(s){if(!s.type.startsWith("image/")){x("ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„");return}f(!0),x(null);try{const c=await S(s,a);r(c)}catch(c){x("ç”»åƒã®å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸ");const p=c instanceof Error?c:new Error(String(c));L(p,{component:"PhotoCapture",action:"handleFileSelect"})}finally{f(!1)}}},[a,r,S]),o=l.useCallback(async()=>{x(null),b(!1);try{const t=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});if(N.current=t,u.current){const s=u.current,d=()=>{s.videoWidth>0&&s.videoHeight>0&&(b(!0),c())},c=()=>{s.removeEventListener("playing",d),s.removeEventListener("loadeddata",d),s.removeEventListener("canplay",d)};s.addEventListener("playing",d),s.addEventListener("loadeddata",d),s.addEventListener("canplay",d),s.srcObject=t,s.play().catch(w=>{console.warn("Video autoplay failed:",w)});let p=0;const j=setInterval(()=>{p++,s.videoWidth>0&&s.videoHeight>0?(b(!0),clearInterval(j),c()):p>50&&(clearInterval(j),c(),x("ã‚«ãƒ¡ãƒ©ã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ"),L(new Error("Video ready timeout"),{component:"PhotoCapture",action:"startCamera",videoWidth:s.videoWidth,videoHeight:s.videoHeight,readyState:s.readyState}))},100)}m("camera")}catch(t){x("ã‚«ãƒ¡ãƒ©ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“");const s=t instanceof Error?t:new Error(String(t));L(s,{component:"PhotoCapture",action:"startCamera"})}},[]),y=l.useCallback(()=>{N.current&&(N.current.getTracks().forEach(t=>t.stop()),N.current=null),b(!1),m("select")},[]),n=l.useCallback(async()=>{if(u.current){f(!0),x(null);try{const t=u.current;if((t.videoWidth===0||t.videoHeight===0)&&await new Promise((j,w)=>{const k=setTimeout(()=>w(new Error("Video not ready")),5e3);t.onloadedmetadata=()=>{clearTimeout(k),j()}}),t.videoWidth===0||t.videoHeight===0)throw new Error("Video dimensions not available");const s=document.createElement("canvas");s.width=t.videoWidth,s.height=t.videoHeight;const d=s.getContext("2d");if(!d)throw new Error("Canvas context not available");d.drawImage(t,0,0);const c=await new Promise((j,w)=>{s.toBlob(k=>k?j(k):w(new Error("Failed to create blob")),"image/jpeg",.9)}),p=await S(c,a);y(),r(p)}catch(t){x("æ’®å½±ã«å¤±æ•—ã—ã¾ã—ãŸ");const s=t instanceof Error?t:new Error(String(t));L(s,{component:"PhotoCapture",action:"captureFromCamera"})}finally{f(!1)}}},[a,r,S,y]);return i==="camera"?e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("video",{ref:u,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full max-w-md rounded-lg border"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:n,disabled:h||!C,className:"rounded-full bg-blue-500 p-4 text-white hover:bg-blue-600 disabled:opacity-50",children:h?"å‡¦ç†ä¸­...":C?"æ’®å½±":"æº–å‚™ä¸­..."}),e.jsx("button",{onClick:y,className:"rounded-lg border px-4 py-2 hover:bg-gray-100",children:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«"})]}),v&&e.jsx("p",{className:"text-sm text-red-500",children:v})]}):e.jsxs("div",{className:"flex flex-col items-center gap-4 p-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"é£Ÿäº‹ã®å†™çœŸã‚’è¿½åŠ "}),e.jsx("input",{ref:I,type:"file",accept:"image/*",onChange:P,className:"hidden"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>{var t;return(t=I.current)==null?void 0:t.click()},disabled:h,className:"flex items-center gap-2 rounded-lg border px-4 py-3 hover:bg-gray-100 disabled:opacity-50",children:[e.jsx("span",{children:"ğŸ“"}),e.jsx("span",{children:"ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ"})]}),e.jsxs("button",{onClick:o,disabled:h,className:"flex items-center gap-2 rounded-lg border px-4 py-3 hover:bg-gray-100 disabled:opacity-50",children:[e.jsx("span",{children:"ğŸ“·"}),e.jsx("span",{children:"ã‚«ãƒ¡ãƒ©ã§æ’®å½±"})]})]}),h&&e.jsx("p",{className:"text-sm text-gray-500",children:"ç”»åƒã‚’å‡¦ç†ä¸­..."}),v&&e.jsx("p",{className:"text-sm text-red-500",children:v}),g&&e.jsx("button",{onClick:g,className:"text-sm text-gray-500 hover:text-gray-700",children:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«"})]})}function U({photoUrl:r,foodItems:g,totals:a,isLoading:i,onUpdateItem:m,onDeleteItem:h,onAddItem:f}){const[C,b]=l.useState(null),[v,x]=l.useState(!1);return i?e.jsxs("div",{className:"flex flex-col items-center gap-4 p-8",children:[e.jsx("div",{className:"h-12 w-12 animate-spin rounded-full border-4 border-blue-500 border-t-transparent"}),e.jsx("p",{className:"text-gray-600",children:"AI ãŒé£Ÿäº‹ã‚’åˆ†æä¸­..."})]}):e.jsxs("div",{className:"flex flex-col gap-4",children:[r&&e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:r,alt:"é£Ÿäº‹ã®å†™çœŸ",className:"max-h-48 rounded-lg object-cover"})}),e.jsxs("div",{className:"rounded-lg bg-blue-50 p-4",children:[e.jsx("h3",{className:"mb-2 font-semibold",children:"åˆè¨ˆ"}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-center text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:a.calories}),e.jsx("div",{className:"text-gray-500",children:"kcal"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:a.protein.toFixed(1)}),e.jsx("div",{className:"text-gray-500",children:"P (g)"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-yellow-600",children:a.fat.toFixed(1)}),e.jsx("div",{className:"text-gray-500",children:"F (g)"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-orange-600",children:a.carbs.toFixed(1)}),e.jsx("div",{className:"text-gray-500",children:"C (g)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold",children:"è­˜åˆ¥ã•ã‚ŒãŸé£Ÿæ"}),g.map(u=>C===u.id?e.jsx(W,{item:u,onSave:async N=>{await(m==null?void 0:m(u.id,N)),b(null)},onCancel:()=>b(null)},u.id):e.jsx(D,{item:u,onEdit:()=>b(u.id),onDelete:()=>h==null?void 0:h(u.id),editable:!!m},u.id))]}),f&&e.jsx("div",{children:v?e.jsx(W,{onSave:async u=>{await f(u),x(!1)},onCancel:()=>x(!1)}):e.jsx("button",{onClick:()=>x(!0),className:"w-full rounded-lg border-2 border-dashed border-gray-300 py-3 text-gray-500 hover:border-gray-400 hover:text-gray-600",children:"+ é£Ÿæã‚’è¿½åŠ "})})]})}function D({item:r,onEdit:g,onDelete:a,editable:i}){const m={small:"å°",medium:"ä¸­",large:"å¤§"}[r.portion];return e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:r.name}),e.jsx("span",{className:"rounded bg-gray-100 px-2 py-0.5 text-xs text-gray-600",children:m})]}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:[r.calories,"kcal | P",r.protein,"g F",r.fat,"g C",r.carbs,"g"]})]}),i&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:g,className:"rounded p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600",children:"âœï¸"}),e.jsx("button",{onClick:a,className:"rounded p-1 text-gray-400 hover:bg-gray-100 hover:text-red-500",children:"ğŸ—‘ï¸"})]})]})}function W({item:r,onSave:g,onCancel:a}){var n,t,s,d;const[i,m]=l.useState((r==null?void 0:r.name)||""),[h,f]=l.useState((r==null?void 0:r.portion)||"medium"),[C,b]=l.useState(((n=r==null?void 0:r.calories)==null?void 0:n.toString())||""),[v,x]=l.useState(((t=r==null?void 0:r.protein)==null?void 0:t.toString())||""),[u,N]=l.useState(((s=r==null?void 0:r.fat)==null?void 0:s.toString())||""),[I,S]=l.useState(((d=r==null?void 0:r.carbs)==null?void 0:d.toString())||""),[P,o]=l.useState(!1),y=async c=>{c.preventDefault(),o(!0);try{await g({name:i,portion:h,calories:parseInt(C)||0,protein:parseFloat(v)||0,fat:parseFloat(u)||0,carbs:parseFloat(I)||0})}finally{o(!1)}};return e.jsxs("form",{onSubmit:y,className:"space-y-3 rounded-lg border p-3",children:[e.jsx("div",{children:e.jsx("input",{type:"text",value:i,onChange:c=>m(c.target.value),placeholder:"é£Ÿæå",required:!0,className:"w-full rounded border px-3 py-2"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:h,onChange:c=>f(c.target.value),className:"rounded border px-3 py-2",children:[e.jsx("option",{value:"small",children:"å°"}),e.jsx("option",{value:"medium",children:"ä¸­"}),e.jsx("option",{value:"large",children:"å¤§"})]}),e.jsx("input",{type:"number",value:C,onChange:c=>b(c.target.value),placeholder:"kcal",required:!0,className:"w-20 rounded border px-3 py-2"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",step:"0.1",value:v,onChange:c=>x(c.target.value),placeholder:"P (g)",className:"w-20 rounded border px-3 py-2"}),e.jsx("input",{type:"number",step:"0.1",value:u,onChange:c=>N(c.target.value),placeholder:"F (g)",className:"w-20 rounded border px-3 py-2"}),e.jsx("input",{type:"number",step:"0.1",value:I,onChange:c=>S(c.target.value),placeholder:"C (g)",className:"w-20 rounded border px-3 py-2"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:a,className:"rounded px-3 py-1 text-gray-500 hover:bg-gray-100",children:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«"}),e.jsx("button",{type:"submit",disabled:P,className:"rounded bg-blue-500 px-3 py-1 text-white hover:bg-blue-600 disabled:opacity-50",children:P?"ä¿å­˜ä¸­...":"ä¿å­˜"})]})]})}function K({mealId:r,currentFoodItems:g,onUpdate:a}){const i=V(),[m,h]=l.useState([]),[f,C]=l.useState(""),[b,v]=l.useState(!1),[x,u]=l.useState([]),N=l.useRef(null);l.useEffect(()=>{(async()=>{try{const{messages:y}=await F.getChatHistory(r);h(y.map(n=>({id:n.id,role:n.role,content:n.content,changes:n.appliedChanges})))}catch(y){console.error("Failed to load chat history:",y),y instanceof TypeError&&y.message==="Failed to fetch"&&i.warning("ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ")}})()},[r,i]),l.useEffect(()=>{var o;(o=N.current)==null||o.scrollIntoView({behavior:"smooth"})},[m]);const I=l.useCallback(async()=>{if(!f.trim()||b)return;const o=f.trim();C(""),v(!0);const y=`user-${Date.now()}`;h(t=>[...t,{id:y,role:"user",content:o}]);const n=`assistant-${Date.now()}`;h(t=>[...t,{id:n,role:"assistant",content:"",isStreaming:!0}]);try{let t="",s=[];for await(const d of F.sendChatMessage(r,o))d.text&&(t+=d.text,h(c=>c.map(p=>p.id===n?{...p,content:t}:p))),d.done&&(s=d.changes||[],h(c=>c.map(p=>p.id===n?{...p,id:d.messageId||n,isStreaming:!1,changes:s}:p)),s.length>0&&u(s)),d.error&&h(c=>c.map(p=>p.id===n?{...p,content:d.error||"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ",isStreaming:!1}:p))}catch(t){console.error("Chat error:",t),h(s=>s.map(d=>d.id===n?{...d,content:"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ",isStreaming:!1}:d))}finally{v(!1)}},[f,b,r]),S=l.useCallback(async()=>{if(x.length!==0)try{const o=await F.applyChatSuggestion(r,x);a(o.foodItems,o.updatedTotals),u([]),i.success("å¤‰æ›´ã‚’é©ç”¨ã—ã¾ã—ãŸ")}catch(o){console.error("Apply changes error:",o),o instanceof TypeError&&o.message==="Failed to fetch"?i.error("ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã§ãã¾ã›ã‚“"):i.error("å¤‰æ›´ã®é©ç”¨ã«å¤±æ•—ã—ã¾ã—ãŸ")}},[r,x,a,i]),P=l.useCallback(o=>{o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),I())},[I]);return e.jsxs("div",{className:"rounded-lg border",children:[e.jsxs("div",{className:"h-64 overflow-y-auto p-4",children:[m.length===0&&e.jsxs("div",{className:"text-center text-gray-400",children:[e.jsx("p",{children:"AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã«è³ªå•ã—ã¦ãã ã•ã„"}),e.jsx("p",{className:"mt-2 text-sm",children:"ä¾‹: ã”é£¯ã‚’åŠåˆ†ã«ã—ãŸã„ã€ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã‚’å¢—ã‚„ã™ã«ã¯ï¼Ÿ"})]}),m.map(o=>e.jsx("div",{className:`mb-3 ${o.role==="user"?"text-right":"text-left"}`,children:e.jsxs("div",{className:`inline-block max-w-[80%] rounded-lg px-4 py-2 ${o.role==="user"?"bg-blue-500 text-white":"bg-gray-100 text-gray-800"}`,children:[o.content,o.isStreaming&&e.jsx("span",{className:"ml-1 animate-pulse",children:"..."})]})},o.id)),e.jsx("div",{ref:N})]}),x.length>0&&e.jsxs("div",{className:"border-t bg-yellow-50 p-3",children:[e.jsx("p",{className:"mb-2 text-sm font-medium",children:"AIã‹ã‚‰ã®å¤‰æ›´ææ¡ˆ:"}),e.jsx("ul",{className:"mb-2 text-sm text-gray-600",children:x.map((o,y)=>{var n;return e.jsxs("li",{children:[o.action==="add"&&`è¿½åŠ : ${(n=o.foodItem)==null?void 0:n.name}`,o.action==="remove"&&"å‰Šé™¤: (é£Ÿæ)",o.action==="update"&&"å¤‰æ›´: (é£Ÿæ)"]},y)})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:S,className:"rounded bg-green-500 px-4 py-1 text-sm text-white hover:bg-green-600",children:"é©ç”¨ã™ã‚‹"}),e.jsx("button",{onClick:()=>u([]),className:"rounded px-4 py-1 text-sm text-gray-500 hover:bg-gray-200",children:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«"})]})]}),e.jsxs("div",{className:"flex border-t p-3",children:[e.jsx("input",{type:"text",value:f,onChange:o=>C(o.target.value),onKeyPress:P,placeholder:"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›...",disabled:b,className:"flex-1 rounded-l-lg border-y border-l px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{onClick:I,disabled:b||!f.trim(),className:"rounded-r-lg bg-blue-500 px-4 py-2 text-white hover:bg-blue-600 disabled:opacity-50",children:"é€ä¿¡"})]})]})}function R(r){return r instanceof TypeError&&r.message==="Failed to fetch"?"ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã§ãã¾ã›ã‚“ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚":r instanceof Error?r.message:"äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ"}function z(){const r=$(),g=V(),[a,i]=l.useState({phase:"capture"}),[m,h]=l.useState(!1),[f,C]=l.useState("lunch"),[b,v]=l.useState(!1),x=l.useCallback(async n=>{i({phase:"analyzing"});try{const t=await F.analyzeMealPhoto(n);if("error"in t){i({phase:"error",message:t.message});return}const s=t;i({phase:"result",mealId:s.mealId,photoUrl:`/api/meals/photos/${encodeURIComponent(s.photoKey)}`,foodItems:s.foodItems,totals:s.totals})}catch(t){console.error("Analysis error:",t),i({phase:"error",message:t instanceof Error?t.message:"åˆ†æä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ"})}},[]),u=l.useCallback(async()=>{i({phase:"creating"});try{const n=await F.createEmptyMeal();i({phase:"result",mealId:n.mealId,photoUrl:void 0,foodItems:[],totals:{calories:0,protein:0,fat:0,carbs:0}})}catch(n){console.error("Create empty meal error:",n),i({phase:"error",message:R(n)})}},[]),N=l.useCallback(async(n,t)=>{if(a.phase==="result")try{const s=await F.updateFoodItem(a.mealId,n,t);i({...a,foodItems:a.foodItems.map(d=>d.id===n?s.foodItem:d),totals:s.updatedTotals})}catch(s){console.error("Update item error:",s),g.error(R(s))}},[a,g]),I=l.useCallback(async n=>{if(a.phase==="result")try{const t=await F.deleteFoodItem(a.mealId,n);i({...a,foodItems:a.foodItems.filter(s=>s.id!==n),totals:t.updatedTotals})}catch(t){console.error("Delete item error:",t),g.error(R(t))}},[a,g]),S=l.useCallback(async n=>{if(a.phase==="result")try{const t=await F.addFoodItem(a.mealId,n);i({...a,foodItems:[...a.foodItems,t.foodItem],totals:t.updatedTotals})}catch(t){console.error("Add item error:",t),g.error(R(t))}},[a,g]),P=l.useCallback((n,t)=>{a.phase==="result"&&i({...a,foodItems:n,totals:t})},[a]),o=l.useCallback(async()=>{if(a.phase==="result"){v(!0);try{await F.saveMealAnalysis(a.mealId,f),g.success("é£Ÿäº‹ã‚’è¨˜éŒ²ã—ã¾ã—ãŸ"),r("/meals")}catch(n){console.error("Save error:",n),g.error(R(n))}finally{v(!1)}}},[a,f,r,g]),y=l.useCallback(()=>{i({phase:"capture"}),h(!1)},[]);return e.jsxs("div",{className:"mx-auto max-w-lg p-4",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold",children:"AIé£Ÿäº‹åˆ†æ"}),a.phase==="result"&&e.jsx("button",{onClick:y,className:"text-sm text-gray-500 hover:text-gray-700",children:"ã‚„ã‚Šç›´ã™"})]}),a.phase==="capture"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(O,{onCapture:x,onCancel:()=>r(-1)}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-1 border-t border-gray-300"}),e.jsx("span",{className:"text-sm text-gray-500",children:"ã¾ãŸã¯"}),e.jsx("div",{className:"flex-1 border-t border-gray-300"})]}),e.jsx("button",{onClick:u,className:"w-full rounded-lg border-2 border-dashed border-gray-300 py-4 text-gray-600 hover:border-blue-400 hover:text-blue-600",children:"æ‰‹å‹•ã§å…¥åŠ›ã™ã‚‹"})]}),a.phase==="creating"&&e.jsxs("div",{className:"flex flex-col items-center gap-4 py-12",children:[e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-blue-500 border-t-transparent"}),e.jsx("p",{className:"text-gray-600",children:"æº–å‚™ä¸­..."})]}),a.phase==="analyzing"&&e.jsx(U,{foodItems:[],totals:{calories:0,protein:0,fat:0,carbs:0},isLoading:!0}),a.phase==="error"&&e.jsxs("div",{className:"flex flex-col items-center gap-4 rounded-lg bg-red-50 p-6",children:[e.jsx("p",{className:"text-red-600",children:a.message}),e.jsx("button",{onClick:y,className:"rounded bg-red-500 px-4 py-2 text-white hover:bg-red-600",children:"ã‚‚ã†ä¸€åº¦æ’®å½±ã™ã‚‹"})]}),a.phase==="result"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(U,{photoUrl:a.photoUrl,foodItems:a.foodItems,totals:a.totals,onUpdateItem:N,onDeleteItem:I,onAddItem:S}),e.jsx("button",{onClick:()=>h(!m),className:"w-full rounded-lg border py-3 text-center hover:bg-gray-50",children:m?"ğŸ’¬ ãƒãƒ£ãƒƒãƒˆã‚’é–‰ã˜ã‚‹":"ğŸ’¬ AIã¨ç›¸è«‡ã—ã¦èª¿æ•´"}),m&&e.jsx(K,{mealId:a.mealId,currentFoodItems:a.foodItems,onUpdate:P}),e.jsxs("div",{className:"rounded-lg bg-gray-50 p-4",children:[e.jsx("h3",{className:"mb-3 font-semibold",children:"è¨˜éŒ²ã¨ã—ã¦ä¿å­˜"}),e.jsx("div",{className:"mb-4 flex gap-2",children:["breakfast","lunch","dinner","snack"].map(n=>e.jsxs("button",{onClick:()=>C(n),className:`flex-1 rounded-lg py-2 text-sm ${f===n?"bg-blue-500 text-white":"bg-white border hover:bg-gray-100"}`,children:[n==="breakfast"&&"æœé£Ÿ",n==="lunch"&&"æ˜¼é£Ÿ",n==="dinner"&&"å¤•é£Ÿ",n==="snack"&&"é–“é£Ÿ"]},n))}),e.jsx("button",{onClick:o,disabled:b||a.foodItems.length===0,className:"w-full rounded-lg bg-blue-500 py-3 font-semibold text-white hover:bg-blue-600 disabled:opacity-50",children:b?"ä¿å­˜ä¸­...":"é£Ÿäº‹ã‚’è¨˜éŒ²ã™ã‚‹"})]})]})]})}export{z as default};
//# sourceMappingURL=MealAnalysis-BgPIeoHl.js.map
